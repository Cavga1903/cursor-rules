---
alwaysApply: true
---

# Development Workflow - Sistemsel Kod Yazma SÃ¼reci

**Bu dosya her kod yazma iÅŸleminde otomatik olarak kontrol edilir.**

**Roadmap ReferansÄ±:** `_bmad-output/planning-artifacts/roadmap.mdc`

---

## ğŸ”„ DÃ¶ngÃ¼sel SÃ¼reÃ§ (Her Kod Yazma Ä°ÅŸleminde)

### PRE-CODE: Kod Yazmadan Ã–nce Kontrol

**1. Ã–ncelik KontrolÃ¼**
- [ ] Roadmap'teki Ã¶ncelik sÄ±rasÄ±nÄ± kontrol et (P0 â†’ P1 â†’ P2 â†’ P3)
- [ ] Åu anki Ã¶ncelik: **Test Infrastructure** (P3.1) veya **UI Refactor** (P3.3)
- [ ] Yeni Ã¶zellik ekliyorsan, roadmap'teki Ã¶ncelik sÄ±rasÄ±na uy mu?

**2. Epic Durumu KontrolÃ¼**
- [ ] Hangi epic'e ait?
- [ ] Epic durumu nedir? (TamamlandÄ± mÄ±? In-progress mi?)
- [ ] Story durumu nedir? (Acceptance criteria'lar tamamlandÄ± mÄ±?)

**3. SÃ¼reÃ§ DÃ¶ngÃ¼sÃ¼ KontrolÃ¼**
- [ ] Hangi aÅŸamadayÄ±z? (Planlama â†’ GeliÅŸtirme â†’ Kalite KontrolÃ¼ â†’ Commit)
- [ ] Planlama yapÄ±ldÄ± mÄ±? (Epic/Story seÃ§imi, Acceptance criteria review)
- [ ] Technical design hazÄ±r mÄ±?

**4. Rules KontrolÃ¼**
- [ ] `roadmaprules.mdc` - Ã–ncelikler ve sÃ¼reÃ§ dÃ¶ngÃ¼sÃ¼
- [ ] `reactrules.mdc` - React performans kurallarÄ±
- [ ] `mvprules.mdc` - MVP kurallarÄ± ve UI consistency

**5. BMad Context KontrolÃ¼ (Kategorize EdilmiÅŸ)**
- [ ] `bmad-context-checker.mdc` - Kategori bazlÄ± kontrol yapÄ±ldÄ± mÄ±?
- [ ] Planning artifacts kontrol edildi mi? (roadmap, prd, epics, architecture)
- [ ] Implementation artifacts kontrol edildi mi? (story files, code reviews)
- [ ] Core documentation kontrol edildi mi? (API contracts, data models, components)
- [ ] Ä°lgili workflow Ã§alÄ±ÅŸtÄ±rÄ±ldÄ± mÄ±? (`_bmad/bmm/workflows/` veya `_bmad/core/workflows/`)

**6. Referans KontrolÃ¼**
- [ ] Design referanslarÄ± var mÄ±? (`stitch_main_pos_terminal_screen/`)
- [ ] UI Refactor sÄ±rasÄ±nda mÄ±yÄ±z? (Design system, Tailwind CSS, Material Symbols)
- [ ] API documentation var mÄ±? (Tauri commands)

---

### DURING-CODE: Kod Yazarken Kontrol

**1. Code Quality Rules**
- [ ] React Hook Compliance (`useCallback`, `useEffect` dependencies)
- [ ] Type Safety (no `any`, proper types)
- [ ] Error Handling (try-catch, Result types)
- [ ] Input Validation (sanitization, length checks)
- [ ] **AI Optimizasyonu:** Dosya boyutu < 250 satÄ±r (ESLint: `max-lines`)
- [ ] **AI Optimizasyonu:** Dosya baÅŸÄ±na tek React component (ESLint: `react/no-multi-comp`)
- [ ] **AI Optimizasyonu:** Fonksiyon boyutu < 50 satÄ±r (ESLint: `max-lines-per-function`)

**2. Performance Rules (Vercel Best Practices)**
- [ ] Waterfall'larÄ± Ã¶nle (Promise.all kullan) - **KRÄ°TÄ°K**
- [ ] Bundle size kontrolÃ¼ (route-based code splitting, lazy loading) - **KRÄ°TÄ°K**
- [ ] N+1 Query problemi var mÄ±? (Batch fetching kullan)
- [ ] Re-render optimizasyonu (`useMemo`, `useCallback`, `React.memo` - sadece gerektiÄŸinde)
- [ ] Bundle analyzer ile Ã¶lÃ§Ã¼m yapÄ±ldÄ± mÄ±? (tahmin etme, Ã¶lÃ§)

**3. Security Rules**
- [ ] Backend role validation var mÄ±? (Owner/Cashier checks)
- [ ] Input sanitization yapÄ±ldÄ± mÄ±?
- [ ] Rate limiting gerekli mi?
- [ ] Session security (sessionStorage kullan)

**4. UI/UX Rules (UI Refactor sÄ±rasÄ±nda)**
- [ ] Tailwind CSS utility classes kullan
- [ ] Design token'larÄ± kullan (`src/design-tokens.ts`)
- [ ] Material Symbols font kullan
- [ ] Stitch design'larÄ±na uy mu?
- [ ] Accessibility (ARIA labels, keyboard navigation)
- [ ] Route-based code splitting (React.lazy + Suspense) - **Vercel Best Practice**
- [ ] Bundle size < 500KB (bundle analyzer ile kontrol)

**5. Pattern'ler ve Best Practices**
- [ ] Mevcut pattern'leri kullan (rate limiting, role validation, logger)
- [ ] Constants kullan (magic numbers yok)
- [ ] i18n keys kullan (hardcoded strings yok)
- [ ] Logger kullan (`console.log` yok)

---

### POST-CODE: Kod YazdÄ±ktan Sonra Kontrol

**1. Quality Gates (Her Commit Ã–ncesi)**
```bash
# Otomatik Ã§alÄ±ÅŸtÄ±r:
npm run mvp:check  # typecheck + cargo check
./scripts/run-cleanup-gates.sh  # Full quality gates
```

- [ ] TypeScript type checking (`npm run typecheck`)
- [ ] Rust compilation check (`cargo check`)
- [ ] Smoke test (`npm run tauri dev` - 15 saniye, panic check)
- [ ] ESLint kontrolÃ¼ (`npm run lint`) - AI optimizasyon kurallarÄ± dahil

**2. Code Review Checklist**
- [ ] Self code review yapÄ±ldÄ± mÄ±?
- [ ] Acceptance criteria'lar karÅŸÄ±landÄ± mÄ±?
- [ ] Security review yapÄ±ldÄ± mÄ±? (role validation, input sanitization)
- [ ] Performance review yapÄ±ldÄ± mÄ±? (N+1 queries, waterfall'lar)

**3. Testing**
- [ ] Local testing yapÄ±ldÄ± mÄ±?
- [ ] Manual testing yapÄ±ldÄ± mÄ±?
- [ ] Test coverage yeterli mi? (hedef: %60+)

**4. Documentation**
- [ ] Code comments eklendi mi? (JSDoc)
- [ ] API documentation gÃ¼ncellendi mi?
- [ ] Component documentation gÃ¼ncellendi mi?
- [ ] Roadmap gÃ¼ncellendi mi? (tamamlanan iÅŸler iÅŸaretlendi mi?)
**5. Git & Commit (Otomatik)**

**GÃ¼venilir DeÄŸiÅŸiklik Kriterleri:**
- âœ… Quality gates geÃ§ti (`npm run dev:gates`)
- âœ… Type checking baÅŸarÄ±lÄ± (`npm run typecheck`)
- âœ… Rust compilation baÅŸarÄ±lÄ± (`cargo check`)
- âœ… Smoke test baÅŸarÄ±lÄ± (`npm run tauri dev` - 15 saniye, panic yok)
- âœ… Manuel test yapÄ±ldÄ± (opsiyonel, kritik deÄŸiÅŸiklikler iÃ§in)

**Otomatik Commit MekanizmasÄ±:**

Her gÃ¼venilir deÄŸiÅŸiklik sonrasÄ±nda otomatik commit yapÄ±lmalÄ±:

```bash
# 1. Quality gates Ã§alÄ±ÅŸtÄ±r
npm run dev:gates

# 2. EÄŸer tÃ¼m gate'ler geÃ§tiyse, commit yap
git add .
git commit -m "feat|fix|refactor|docs|style|test|chore(scope): description

- Detay 1
- Detay 2

Related: Epic-X, Story-X.Y"
```

**Conventional Commits FormatÄ±:**
- `feat:` - Yeni Ã¶zellik
- `fix:` - Bug fix
- `refactor:` - Refactoring (kod iyileÅŸtirme)
- `docs:` - DokÃ¼mantasyon
- `style:` - Code style (formatting, whitespace)
- `test:` - Test ekleme/dÃ¼zenleme
- `chore:` - Genel bakÄ±m (dependencies, config)

**Commit Scope Ã–rnekleri:**
- `feat(auth):` - Authentication Ã¶zelliÄŸi
- `fix(pos):` - POS bug fix
- `refactor(stock):` - Stock refactoring
- `docs(api):` - API dokÃ¼mantasyonu
- `test(auth):` - Authentication testleri

**Commit Message Ã–rnekleri:**
```bash
# Yeni Ã¶zellik
git commit -m "feat(test): add Vitest test framework setup

- Install Vitest + React Testing Library
- Configure vitest.config.ts
- Add test directory structure

Related: P3.1"

# Bug fix
git commit -m "fix(auth): fix race condition in session check

- Use functional state updates
- Add mounted flag to prevent stale closures
- Fix useEffect dependency array

Related: C5"

# Refactoring
git commit -m "refactor(pos): extract magic numbers to constants

- Add ANIMATION_DURATION constant
- Add SEARCH_DEBOUNCE_DELAY constant
- Replace hardcoded numbers in POS.tsx

Related: P2"
```

**Otomatik Commit KurallarÄ±:**
1. âœ… Quality gates geÃ§tiyse â†’ Commit yap
2. âœ… KÃ¼Ã§Ã¼k, atomik deÄŸiÅŸiklikler â†’ Her deÄŸiÅŸiklik iÃ§in commit
3. âœ… BÃ¼yÃ¼k deÄŸiÅŸiklikler â†’ Feature branch'te commit, main'e merge
4. âœ… Related epic/story referansÄ± ekle
5. âœ… Breaking changes varsa â†’ `BREAKING CHANGE:` notu ekle

---

## ğŸ¯ Ã–ncelik BazlÄ± Kontrol Listesi

### P0 (CRITICAL) - GÃ¼venlik
**Kod yazarken kontrol et:**
- [ ] Rate limiting gerekli mi? (login, sensitive operations)
- [ ] Timing attack korumasÄ± var mÄ±? (bcrypt::verify)
- [ ] Input sanitization yapÄ±ldÄ± mÄ±?
- [ ] Backend validation var mÄ±? (frontend-only validation yeterli deÄŸil)
- [ ] Session security (sessionStorage, TTL)

### P1 (HIGH) - Code Quality
**Kod yazarken kontrol et:**
- [ ] Backend role validation var mÄ±? (Owner/Cashier checks)
- [ ] React Hook Compliance (`useCallback`, `useEffect` dependencies)
- [ ] setTimeout cleanup var mÄ±? (`clearTimeout`)
- [ ] N+1 Query problemi var mÄ±? (Batch fetching)
- [ ] Database indexes var mÄ±? (Performance)

### P2 (MEDIUM) - Code Quality Improvements
**Kod yazarken kontrol et:**
- [ ] Logger kullanÄ±ldÄ± mÄ±? (`console.log` yok)
- [ ] Type safety (no `any`, proper types)
- [ ] Constants kullanÄ±ldÄ± mÄ±? (magic numbers yok)
- [ ] i18n keys kullanÄ±ldÄ± mÄ±? (hardcoded strings yok)

### P3 (HIGH) - Ãœretim HazÄ±rlÄ±ÄŸÄ±
**Kod yazarken kontrol et:**
- [ ] Test yazÄ±ldÄ± mÄ±? (Test Infrastructure aktifse)
- [ ] Documentation gÃ¼ncellendi mi?
- [ ] UI Refactor kurallarÄ±na uy mu? (UI Refactor sÄ±rasÄ±nda)
- [ ] Performance optimization yapÄ±ldÄ± mÄ±?

---

## ğŸ” Epic BazlÄ± Kontrol Listesi

### Epic 1-6: TamamlandÄ± âœ…
**Yeni Ã¶zellik eklerken:**
- [ ] Mevcut epic'lere uyumlu mu?
- [ ] Breaking change var mÄ±?
- [ ] Backward compatibility korundu mu?

### Epic 7: In-Progress âš ï¸
**Kod yazarken:**
- [ ] Story 7.5 (Hata Kurtarma) ile ilgili mi?
- [ ] Structured error logging gerekli mi?
- [ ] Error recovery UI iyileÅŸtirmesi gerekli mi?

### Epic 8: TamamlandÄ± âœ…
**Kod yazarken:**
- [ ] i18n keys kullanÄ±ldÄ± mÄ±?
- [ ] TÃ¼rkÃ§e mesajlar doÄŸru mu?

---

## ğŸ¨ UI Refactor Kontrol Listesi (P3.3 Aktifse)

### Phase 1: Design System Foundation
**Kod yazarken:**
- [ ] Tailwind CSS kuruldu mu?
- [ ] Material Symbols font eklendi mi?
- [ ] Design tokens oluÅŸturuldu mu? (`src/design-tokens.ts`)
- [ ] Color palette extraction yapÄ±ldÄ± mÄ±?

### Phase 2-6: Component & Screen Refactor
**Kod yazarken:**
- [ ] Stitch design'larÄ±na uy mu? (`stitch_main_pos_terminal_screen/`)
- [ ] Tailwind utility classes kullanÄ±ldÄ± mÄ±?
- [ ] Design token'larÄ± kullanÄ±ldÄ± mÄ±?
- [ ] Component library'den component'ler kullanÄ±ldÄ± mÄ±?
- [ ] Custom CSS yazÄ±ldÄ± mÄ±? (mÃ¼mkÃ¼nse Tailwind kullan)

---

## ğŸ“‹ Otomatik Kontrol Script'leri

### Pre-Commit Hook (Ã–nerilen)
```bash
#!/bin/bash
# .git/hooks/pre-commit

# Quality gates
npm run mvp:check
if [ $? -ne 0 ]; then
  echo "âŒ Quality gates failed. Commit aborted."
  exit 1
fi
```

### Development Checklist Script
```bash
#!/bin/bash
# scripts/dev-checklist.sh

echo "ğŸ” Development Checklist"
echo "1. Ã–ncelik kontrolÃ¼..."
echo "2. Epic durumu kontrolÃ¼..."
echo "3. Rules kontrolÃ¼..."
echo "4. Quality gates..."
```

---

## ğŸš€ HÄ±zlÄ± Referans

### "BaÅŸla" Komutu (Otomatik BaÅŸlangÄ±Ã§)

**KullanÄ±cÄ± "baÅŸla" dediÄŸinde sistem otomatik olarak:**

1. âœ… Roadmap'i kontrol et (`roadmap.mdc`) - Åu anki Ã¶nceliÄŸi belirle
2. âœ… Epic durumunu kontrol et - Hangi epic'ler tamamlandÄ±?
3. âœ… Ä°lgili senaryoyu seÃ§ (Test Infrastructure, UI Refactor, Documentation, Performance)
4. âœ… Ä°lgili dosyalarÄ± kontrol et (planning artifacts, implementation artifacts)
5. âœ… Ä°lgili workflow'larÄ± belirle
6. âœ… Ä°lk adÄ±mlarÄ± gÃ¶ster

**Referans:** `start-guide.mdc` - Otomatik baÅŸlangÄ±Ã§ senaryolarÄ± ve ilk adÄ±mlar

---

### "Devam Et" Komutu (Otomatik Devam)

**KullanÄ±cÄ± "devam et" dediÄŸinde sistem otomatik olarak:**

1. âœ… Son yapÄ±lan iÅŸi kontrol et (roadmap, epic, story)
2. âœ… Epic durumunu kontrol et (tamamlandÄ± mÄ±? in-progress mi?)
3. âœ… Story durumunu kontrol et (acceptance criteria tamamlandÄ± mÄ±?)
4. âœ… Workflow durumunu kontrol et (yarÄ±da kaldÄ± mÄ±?)
5. âœ… Bir sonraki adÄ±mÄ± belirle (epic, story, workflow)
6. âœ… Ä°lgili dosyalarÄ± kontrol et (story file, code review, planning artifacts)
7. âœ… Ä°lgili workflow'u devam ettir veya baÅŸlat

**Referans:** `start-guide.mdc` - "Devam Et" komutu senaryolarÄ± ve devam adÄ±mlarÄ±

**Senaryolar:**
- Epic in-progress â†’ Epic'e devam et
- Story in-progress â†’ Story'ye devam et
- Workflow yarÄ±da kaldÄ± â†’ Workflow'u `--resume` ile devam ettir
- Ä°ÅŸ tamamlandÄ± â†’ Bir sonraki Ã¶ncelikli iÅŸe geÃ§

---

**Kod yazmadan Ã¶nce:**
1. Development checklist Ã§alÄ±ÅŸtÄ±r: `npm run dev:checklist`
2. Roadmap'i kontrol et: `_bmad-output/planning-artifacts/roadmap.mdc` â­ ZORUNLU
3. BMad context kontrolÃ¼ yap: `bmad-context-checker.mdc` - Kategori bazlÄ±
4. Ã–ncelik sÄ±rasÄ±nÄ± kontrol et: P0 â†’ P1 â†’ P2 â†’ P3
5. Epic durumunu kontrol et: TamamlandÄ± mÄ±? In-progress mi?
6. Ä°lgili workflow'u Ã§alÄ±ÅŸtÄ±r (gerekirse): `_bmad/bmm/workflows/` veya `_bmad/core/workflows/`
7. SÃ¼reÃ§ dÃ¶ngÃ¼sÃ¼nÃ¼ takip et: `development-workflow.mdc`
8. Quality gate'leri Ã§alÄ±ÅŸtÄ±r: `npm run dev:gates`
9. Roadmap'i gÃ¼ncelle

**BMad Context KontrolÃ¼ (Kategorize EdilmiÅŸ):**
- **Feature Ekleme:** Planning artifacts (prd, epics, architecture)
- **UI DeÄŸiÅŸikliÄŸi:** UI refresh plan, UX design spec
- **Backend DeÄŸiÅŸikliÄŸi:** API contracts, data models
- **Frontend DeÄŸiÅŸikliÄŸi:** Component inventory
- **Story Implementation:** Story file, code review

**Rules KontrolÃ¼:**
- `roadmaprules.mdc` - Ã–ncelikler ve sÃ¼reÃ§ dÃ¶ngÃ¼sÃ¼
- `reactrules.mdc` - React performans kurallarÄ± (Vercel Best Practices)
- `mvprules.mdc` - MVP kurallarÄ± ve UI consistency

**Kod yazarken:**
1. Code quality rules'a uy
2. Performance rules'a uy
3. Security rules'a uy
4. UI/UX rules'a uy (UI Refactor sÄ±rasÄ±nda)
5. Pattern'leri kullan

**Kod yazdÄ±ktan sonra:**
1. Quality gates Ã§alÄ±ÅŸtÄ±r (`npm run dev:gates`)
2. Self code review yap
3. Testing yap
4. Documentation gÃ¼ncelle
5. Roadmap gÃ¼ncelle
6. **Otomatik Commit:** GÃ¼venilir deÄŸiÅŸiklikler iÃ§in commit yap
   ```bash
   # Quality gates geÃ§tiyse otomatik commit
   npm run dev:gates && git add . && git commit -m "feat|fix|refactor(scope): description"
   ```

---

## ğŸ”„ SÃ¼rekli Ä°yileÅŸtirme

**Her kod yazma iÅŸleminden sonra:**
1. **Ã–ÄŸrenme:** Ne Ã§alÄ±ÅŸtÄ±? Ne Ã§alÄ±ÅŸmadÄ±?
2. **DokÃ¼mantasyon:** Ã–ÄŸrenilen dersler â†’ dokÃ¼mantasyon
3. **Otomasyon:** Tekrarlayan iÅŸler â†’ script'ler
4. **StandartlaÅŸtÄ±rma:** Pattern'ler â†’ template'ler

**Roadmap gÃ¼ncellemesi:**
- Tamamlanan iÅŸleri iÅŸaretle
- Yeni sorunlarÄ± ekle
- Ã–ncelikleri gÃ¼ncelle
- SÃ¼reÃ§ iyileÅŸtirmelerini ekle

---

**Son GÃ¼ncelleme:** 2026-01-18  
**Versiyon:** 1.0.0
